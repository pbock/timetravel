"use strict";(function(t,n){if(typeof define==="function"&&define.amd){define([],n)}else if(typeof exports==="object"){module.exports=n()}else{t.Timetravel=n()}})(this,function(){var t;var n=function(e){if(this.Clock){return new n(e)}var i=this;var r,f;var u={};var s={time:Date.now(),speed:1,earliest:-Infinity,latest:Infinity};function o(t){if(!u[t])return;for(var n=0,e=u[t].length;n<e;n++){u[t][n](c())}}function a(){return(new Date).valueOf()}function c(){var t=r+x()*s.speed*h();return p(t)}function h(){return a()-f}function l(){r=c();f=a()}function p(t){return Math.max(s.earliest,Math.min(s.latest,t))}function v(t){l();r=p(t.valueOf());o("timechange");return i}function d(){return c()}var m;function y(n){if(n===t)return s.speed;l();s.speed=n;if(m!==n)o("speedchange");m=n;return i}var g;function O(){if(k()){l();y(g);o("start")}return i}function w(){if(x()){l();g=y();y(0);o("stop")}return i}function k(){return!y()}function x(){return!!y()}function b(n){if(n===t)return d();return v(n)}function j(n){if(n===t)return s.earliest;s.earliest=n;return i}function C(n){if(n===t)return s.latest;s.latest=n;return i}function D(t,n){if(typeof t==="string")t=t.split(/[,\s]+/g);t.forEach(function(t){if(!u[t])u[t]=[];u[t].push(n)});return i}if(e){Object.keys(e).forEach(function(t){if(e.hasOwnProperty(t))s[t]=e[t]})}m=y();v(s.time.valueOf());this.time=b;this.speed=y;this.earliest=j;this.latest=C;this.start=O;this.stop=w;this.isStopped=k;this.isRunning=x;this.on=D};return{Clock:n}});